---
openapi: 3.0.0
info:
  title: Plumber API
  description: Real-time performance and health monitoring.
  version: 1.0.0
paths:
  /v1/webhooks:
    get:
      operationId: ListWebhooks
      responses:
        "200":
          description: lorem ipsum.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebhooksList'
    post:
      operationId: CreateWebhook
      requestBody:
        $ref: '#/components/requestBodies/WebhookCreateInput'
      responses:
        "200":
          description: lorem ipsum.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Webhook'
                
  /v1/webhooks/{webhookId}:
    parameters:
    - name: webhookId
      in: path
      required: true
      schema:
        type: string
    get:
      operationId: GetWebhook
      responses:
        "200":
          description: lorem ipsum.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Webhook'
                
  /v1/webhooks/{webhookId}/events:
    parameters:
    - name: webhookId
      in: path
      required: true
      schema:
        type: string
    post:
      operationId: CreateEvent
      summary: Cancel payment
      description: lorem
      responses:
        "200":
          description: netdata basic information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
      requestBody:
        $ref: '#/components/requestBodies/EventCreateInput'
                
  /v1/webhooks/{webhookId}/targets:
    parameters:
    - name: webhookId
      in: path
      required: true
      schema:
        type: string
    post:
      operationId: CreateTarget
      summary: Cancel payment
      description: lorem
      responses:
        "200":
          description: netdata basic information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Target'
      requestBody:
        $ref: '#/components/requestBodies/TargetCreateInput'

  /v1/webhooks/{webhookId}/targets/{targetId}/tokens:
    parameters:
    - name: webhookId
      in: path
      required: true
      schema:
        type: string
    - name: targetId
      in: path
      required: true
      schema:
        type: string
    post:
      operationId: CreateToken
      summary: Cancel payment
      description: lorem
      responses:
        "200":
          description: netdata basic information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Token'

components:
  requestBodies:
    EventCreateInput:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/EventCreateInput'

    TargetCreateInput:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/TargetCreateInput'


    WebhookCreateInput:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/WebhookCreateInput'
            
  schemas:
    WebhooksList:
      type: object
      properties:
        webhooks:
          type: array
          items:
            $ref: '#/components/schemas/Webhook'
            
    Webhook:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string

    Token:
      type: object
      properties:
        secret:
          type: string
        created_at:
          type: string
          format: date-time

    WebhookCreateInput:
      type: object
      properties:
        name:
          type: string

    EventCreateInput:
      type: object
      properties:
        type:
          type: string
          example: customer.subscribe
        data:
          type: object

    TargetCreateInput:
      type: object
      properties:
        url:
          type: string
          example: "https://example.com/v1/customers"
        ca_certificate:
          type: string
        client_certificate:
          type: string


    Event:
      type: object
      properties:
        id: 
          type: string
          format: uuid
        type:
          type: string
          example: "customer.create"
        data:
          type: object
        status:
          type: object
          properties:
            code:
              type: integer
            class:
              type: string
              enum:
              - SUCCESS
              - FAILURE
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    Target:
      type: object
      properties:
        id: 
          type: string
          format: uuid
        type:
          type: string
          example: "customer.create"
        data:
          type: object
        status:
          type: object
          properties:
            code:
              type: integer
            class:
              type: string
              enum:
              - SUCCESS
              - FAILURE
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

